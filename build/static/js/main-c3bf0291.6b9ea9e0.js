"use strict";(self.webpackChunkssv_front=self.webpackChunkssv_front||[]).push([[6030],{50546:function(e,t,n){n.d(t,{Z:function(){return b}});var a=n(1413),i=n(29439),s=n(89480),c=n(72791),l=n(83958),r=n(98845),o=n(27582),d=n(43751),u=n(62603),m=n(87309),h=n(89501),f=n(67838),p=n(7477),x=n(80184),v=[{name:"",label:"address",require:!0}],g=function(e){var t=e.data,n=t.title,a=t.key,s=t.detailTitle,g=t.placeholder,j=t.detailLabel,b=t.icon,Z=t.open,N=e.dataSource,y=(0,c.useState)(""),_=(0,i.Z)(y,2),k=_[0],w=_[1],C=r.Z.useForm(),S=(0,i.Z)(C,1)[0],I=(0,c.useState)(!1),A=(0,i.Z)(I,2),D=A[0],E=A[1],L=function(t){e.onChange&&e.onChange("action",t)};(0,c.useEffect)((function(){T("default",N)}),[N]);var T=function(e,t){if(S)if("test"===e)E(!0),p.Z.post("".concat(l.bB,"alerting/subscribes/action-test"),{notification_address:k,notification_type:n.toLocaleLowerCase()}).then((function(e){E(!1)})).catch((function(){E(!1)}));else if(t&&"default"===e){var a=S.getFieldsValue();Object.keys(a).forEach((function(e){S.setFieldValue(e,a[e])}))}};return(0,x.jsx)(o.Z,{title:"",open:Z,wrapClassName:"ssv-modal action-modal-wrap",footer:null,width:580,onCancel:function(){return e.onChange("show",!1)},children:(0,x.jsxs)("div",{className:"action-detail",children:[(0,x.jsxs)("div",{className:"action-detail-title",children:[b,(0,x.jsx)("span",{className:"action-modal-lable",children:n})]}),(0,x.jsxs)("div",{className:"action-detail-header",children:[(0,x.jsx)("h3",{className:"title",children:s}),(0,x.jsxs)("span",{className:"detail",children:["Send notifications to",(0,x.jsx)("span",{style:{color:"#1BA5F8",marginLeft:"3px"},children:k})]})]}),(0,x.jsxs)(r.Z,{form:S,layout:"vertical",initialValues:e.dataSource,className:"from-content",onFinish:L,children:[v.map((function(e){return(0,x.jsx)(r.Z.Item,{label:(0,x.jsxs)("span",{className:"item-label",children:[j||"".concat(n," ").concat(e.label),j&&(0,x.jsx)(d.Z,{placement:"topLeft",title:"How to set up Webhook automated messages?",children:(0,x.jsx)(h.Z,{style:{marginLeft:6,cursor:"pointer"},onClick:function(){window.open("https://support.discord.com/hc/en-us/articles/228383668-Intro-to-Webhooks")}})})]}),name:a,required:e.require,children:(0,x.jsx)(u.Z,{placeholder:g,className:"item-input default-border",onChange:function(e){w(e.target.value)}})},e.label)})),(0,x.jsxs)(r.Z.Item,{className:"from-btns",wrapperCol:{span:24},children:[(0,x.jsx)("div",{className:"default-border default-btn-border",style:{minWidth:140,textAlign:"center"},onClick:function(){return T("test")},children:(0,x.jsx)("span",{className:"text",children:D?(0,x.jsx)(f.Z,{style:{color:"#fff"}}):"Test send"})}),(0,x.jsx)(m.Z,{className:"default-btn",type:"primary",htmlType:"submit",onClick:L,children:"Confirm"})]})]})]})})},j=[{title:"Discord",text:"Post a notification message to Discord",icon:(0,s.d)("discode_bg"),key:"discord",detailTitle:"Action",detailLabel:"Discord Webhook URL",placeholder:"https://discord.com/api/webhooks/xxxxxxx/xxxxxx"},{title:"Email",text:"Send an Email notification",icon:(0,s.d)("email_bg"),key:"email",detailTitle:"Action",placeholder:"example@email.com"},{title:"Webhook",text:"Create a Webhook API notification",icon:(0,s.d)("webhook_bg"),key:"webhook",detailTitle:"Action",placeholder:""}],b=function(e){var t=e.onChange,n=e.dataSource,s=(0,c.useState)({}),l=(0,i.Z)(s,2),r=l[0],o=l[1];return(0,x.jsxs)("div",{className:"action-card",children:[(0,x.jsx)("h3",{className:"title",children:" Action"}),(0,x.jsx)("div",{className:"action-card-content",children:j.map((function(e){return(0,x.jsxs)("div",{className:"action-card-content-item",onClick:function(){return function(e){o((0,a.Z)((0,a.Z)({},e),{},{open:!0}))}(e)},children:[(0,x.jsx)("span",{className:"img-svg",children:e.icon}),(0,x.jsxs)("p",{className:"item-text",children:[(0,x.jsx)("span",{className:"title",children:e.title}),(0,x.jsx)("span",{className:"text",children:e.text})]})]},e.title)}))}),(0,x.jsx)(g,{data:r,onChange:function(e,n){t(e,n),o({open:!1})},dataSource:n})]})}},64182:function(e,t,n){var a=n(1413),i=n(29439),s=n(83958),c=n(72791),l=(n(15738),n(60438)),r=n.n(l),o=n(87309),d=n(68058),u=n(7477),m=n(95048),h=n(57689),f=n(67838),p=n(80184);t.Z=function(){var e=(0,c.useState)([]),t=(0,i.Z)(e,2),n=t[0],l=t[1],x=(0,c.useState)(1),v=(0,i.Z)(x,2),g=v[0],j=v[1],b=(0,c.useState)(1),Z=(0,i.Z)(b,2),N=Z[0],y=Z[1],_=(0,c.useState)(!1),k=(0,i.Z)(_,2),w=k[0],C=k[1],S=(0,h.UO)();(0,c.useEffect)((function(){S.id&&S.sign&&u.Z.post("".concat(s.bB,"/alerting/alerts/").concat(S.id,"/confirm-via-sign"),{sign:S.sign&&decodeURIComponent(S.sign)}).then((function(){D()})).catch((function(){D()}))}),[S.id,S.sign]);var I=[{title:"Name",dataIndex:"subscribe__name",width:"25%"},{title:"ID",dataIndex:"id",width:"20%"},{title:"Time Triggered",dataIndex:"create_time",width:"30%",render:function(e,t){return r().utc(e).format("YYYY-MM-DD hh:mm:ss")+" (UTC)"}},{title:"",dataIndex:"confirmed",width:"25%",aligin:"right",render:function(e,t){var n=e?"Acknowledged":"Acknowledge";return(0,p.jsx)("div",{className:"Acknowledge"===n?"edit-btn default-border":"edit-btn default-border disable-btn",onClick:function(){"Acknowledge"===n&&E(t.id)},style:{textAlign:"right"},children:(0,p.jsx)("span",{className:"Acknowledge"===n?"text":"gary-text",children:n})})}}],A=(0,m.v9)((function(e){return null==e?void 0:e.user.public_key}),m.wU),D=function(e){var t={page:e||g,page_size:s.Dh,ordering:"-id"};u.Z.get("".concat(s.bB,"alerting/alerts?page=").concat(t.page,"&page_size=").concat(t.page_size,"&&ordering=-id")).then((function(e){var t;l(null==e||null===(t=e.data)||void 0===t?void 0:t.results),y(null==e?void 0:e.data.count),C(!1)})).catch((function(e){C(!1)}))},E=function(e){"all"===e?u.Z.post("".concat(s.bB,"alerting/alerts/confirm-all")).then((function(e){D()})):u.Z.post("".concat(s.bB,"alerting/alerts/").concat(e,"/confirm")).then((function(e){var t=e.data,i=n.map((function(e){return e.id===t.id?t:(0,a.Z)({},e)}));l(i)}))};return(0,c.useEffect)((function(){C(!0),A&&!S.id&&D()}),[A,S.id]),(0,p.jsxs)("div",{className:"ssv-main",children:[(0,p.jsxs)("div",{className:"ssv-main-header",children:[(0,p.jsx)("h3",{className:"title",children:"Alerts Triggered"}),(0,p.jsx)(o.Z,{style:{background:n.find((function(e){return!e.confirmed}))?"":"gray"},className:"default-btn add-btn",onClick:function(){E("all")},children:"Acknowledge All"})]}),(0,p.jsxs)("div",{className:"ssv-main-content",children:[(0,p.jsx)("ul",{className:"header",children:I.map((function(e,t){return(0,p.jsx)("li",{style:{width:e.width},className:"header-item",children:e.title},t)}))}),w&&(0,p.jsx)("div",{className:"loading",children:(0,p.jsx)(f.Z,{style:{fontSize:50}})}),!w&&(0,p.jsx)("ul",{className:"data-content",children:n.map((function(e,t){return(0,p.jsx)("li",{className:"data-content-item",children:I.map((function(t){var n=t.render?t.render(e[t.dataIndex],e):String(e[t.dataIndex]);return(0,p.jsx)("span",{style:{width:t.width,textAlign:t.aligin||"left"},children:n},t.dataIndex)}))},t)}))})]}),(0,p.jsx)(d.Z,{className:"ssv-pagination",defaultCurrent:g,defaultPageSize:s.Dh,total:N,onChange:function(e){j(e),D(e)}})]})}},69771:function(e,t,n){var a=n(29439),i=n(83958),s=n(89480),c=n(87309),l=n(7477),r=n(72791),o=n(57689),d=n(11087),u=(n(15738),n(80184));t.Z=function(){var e=(0,o.UO)(),t=(0,r.useState)("confirm_right"),n=(0,a.Z)(t,2),m=n[0],h=n[1],f=(0,d.lr)(),p=(0,a.Z)(f,1)[0].get("name"),x=(0,o.s0)();return(0,r.useEffect)((function(){l.Z.post("".concat(i.bB,"/alerting/alerts/").concat(e.id,"/confirm-via-sign"),{sign:e.sign&&decodeURIComponent(e.sign)}).then((function(e){h("confirm_right")})).catch((function(e){h("confirm_error")}))}),[e.id]),(0,u.jsxs)("div",{className:"ssv-main confirm-body",children:[(0,s.d)(m),(0,u.jsx)("h3",{className:"header-title",children:"confirm_right"===m?"Acknowledge successful":"Acknowledge error"}),(0,u.jsxs)("p",{className:"p-label",children:[(0,u.jsx)("span",{className:"label",children:" ID:"}),(0,u.jsx)("span",{children:e.id})]}),p&&(0,u.jsxs)("p",{className:"p-label",children:[(0,u.jsx)("span",{className:"label",children:" Name:"}),(0,u.jsx)("span",{children:decodeURIComponent(p)})]}),(0,u.jsx)(c.Z,{className:"default-btn",onClick:function(){x("/alerts")},children:"Go to list of alerts"})]})}},61922:function(e,t,n){n.d(t,{Z:function(){return g}});var a=n(4942),i=n(1413),s=n(29439),c=n(32014),l=n(57273),r=n(62603),o=n(47422),d=n(72791),u=n(7477),m=n(83958),h=n(57689),f=n(60438),p=n.n(f),x=n(23442),v=n(80184),g=function(){var e,t=(0,d.useState)({}),n=(0,s.Z)(t,2),f=n[0],g=n[1],j=(0,d.useState)({}),b=(0,s.Z)(j,2),Z=b[0],N=b[1],y=(0,d.useState)({}),_=(0,s.Z)(y,2),k=_[0],w=_[1],C=(0,d.useState)(""),S=(0,s.Z)(C,2),I=S[0],A=S[1],D=(0,d.useState)({}),E=(0,s.Z)(D,2),L=E[0],T=E[1],Y=(0,h.UO)().id;(0,d.useEffect)((function(){u.Z.get("".concat(m.bB,"/engine/metrics/").concat(Y)).then((function(e){g(e.data)}))}),[Y]);var z=function(e,t){var n;w((0,i.Z)((0,i.Z)({},k),{},(0,a.Z)({},e,t))),n=(0,i.Z)((0,i.Z)({},k),{},(0,a.Z)({},e,t)),u.Z.post("".concat(m.bB,"/engine/metrics/").concat(Y,"/history"),(0,i.Z)({key:f.key,display:f.display,fields_attr:f.fields_attr,rule_template:f.rule_template,rules_hint:f.rules_hint,query_attr:f.query_attr,query_template:f.query_template,group:f.group},n)).then((function(e){var t,n,a,i,s,c={},l=[{type:"line",data:[],symbolSize:6}],r={};Object.keys(null===(t=e.data)||void 0===t?void 0:t.history_value_map).length>0?(c={type:"category",data:[]},r={type:"category",axisLine:{onZero:!1},data:[],splitLine:{show:!0}},Object.keys(null===(a=e.data)||void 0===a?void 0:a.history_value_map).reverse().forEach((function(t){var n;r.data.push(null===(n=e.data)||void 0===n?void 0:n.history_value_map[t])})),e.data.human_data.forEach((function(e){var t=1e3*Number(e[0]),n=p().utc(t).format("YYYY-MM-DD HH:mm:ss");c.data.push(n);var a=[n,e[1]];l[0].data.push([].concat(a))}))):(r={type:"value",name:null===(i=e.data)||void 0===i?void 0:i.history_y_unit},c={type:"category",data:[]},null===(s=e.data)||void 0===s||s.data.forEach((function(e){var t=1e3*Number(e[0]);c.data.push(p().utc(t).format("YYYY-MM-DD HH:mm:ss")),l[0].data.push(e[1])}))),A(null===(n=e.data)||void 0===n?void 0:n.history_display_name),T({xAxis:c,series:l,yAxis:r})}))},q=function(e,t){var n=((null==e?void 0:e.choices)||[]).map((function(e){return{label:e[1],value:e[0]}}));switch(e.remote_url&&!Z[e.remote_url]&&null!=e&&e.is_remote&&u.Z.get("".concat(m.Fy).concat(e.remote_url)).then((function(n){if(n.data){var s=(0,a.Z)({},e.remote_url,n.data.map((function(e){return{label:e[1],value:e[0]}})));z(t,s[e.remote_url][0].value),N((0,i.Z)((0,i.Z)({},Z),s))}})),e.type){case"CHOICE":return(0,v.jsx)(c.Z.Group,{className:"item-checkbox item-content",options:n});case"SELECT":return(0,v.jsx)(l.Z,{showSearch:!0,onChange:function(e){return z(t,e)},className:"item-select default-border item-content",popupClassName:"item-select-wrap",filterOption:function(e,t){var n,a;return null===(n=String(null!==(a=null==t?void 0:t.label)&&void 0!==a?a:""))||void 0===n?void 0:n.toLowerCase().includes(e.toLowerCase())},value:k&&k[t]||"",options:n.length>0?n:Z[e.remote_url]});case"INPUT":return(0,v.jsx)(r.Z,{className:"item-input default-border item-content"});default:return null}};return(0,v.jsxs)("div",{className:"ssv-content history-content",children:[(0,v.jsx)("h3",{className:"title",children:I}),(0,v.jsx)("div",{className:"from-content history-card",children:(null==f?void 0:f.query_attr)&&(null===(e=Object.keys(null==f?void 0:f.query_attr))||void 0===e?void 0:e.map((function(e,t){var n=f.query_attr[e];return(0,v.jsxs)("div",{className:"history-card-item",children:[(0,v.jsxs)("span",{className:"item-title",children:[(0,x.ZN)(e),":"]}),q(n,e)]},t)})))}),(0,v.jsx)(o.Z,{options:(0,i.Z)({},L)})]})}},37502:function(e,t,n){var a=n(29439),i=n(83958),s=n(72791),c=n(87309),l=n(68058),r=n(735),o=(n(15738),n(57689)),d=n(67838),u=n(7477),m=n(80184);t.Z=function(){var e=(0,s.useState)([]),t=(0,a.Z)(e,2),n=t[0],h=t[1],f=(0,s.useState)(1),p=(0,a.Z)(f,2),x=p[0],v=p[1],g=(0,s.useState)(1),j=(0,a.Z)(g,2),b=j[0],Z=j[1],N=(0,o.s0)(),y=(0,s.useState)(!1),_=(0,a.Z)(y,2),k=_[0],w=_[1],C=[{title:"Metric",dataIndex:"history_display_name",width:"40%"},{title:"Role",dataIndex:"group__name",width:"40%"},{title:"",dataIndex:"",width:"20%",render:function(e,t){return"operator_fee_change"===t.key||t.key,(0,m.jsx)("span",{className:"default-border edit-btn",style:{cursor:"pointer",float:"right"},onClick:function(){N("/history/".concat(t.id))},children:(0,m.jsxs)("span",{className:"text",children:[(0,m.jsx)(r.Z,{className:"icon"}),"History"]})})}}],S=function(e){var t={page:e||x,page_size:i.Dh,ordering:"-id"};u.Z.get("".concat(i.bB,"engine/metrics?page=").concat(t.page,"&page_size=").concat(t.page_size,"&&ordering=-id")).then((function(e){var t,n;h(null==e||null===(t=e.data)||void 0===t?void 0:t.results),Z(null==e||null===(n=e.data)||void 0===n?void 0:n.count),w(!1)})).catch((function(){w(!1)}))};return(0,s.useEffect)((function(){w(!0),S()}),[]),(0,m.jsxs)("div",{className:"ssv-main",children:[(0,m.jsxs)("div",{className:"ssv-main-header",children:[(0,m.jsx)("h3",{className:"title",children:"Metrics"}),(0,m.jsx)(c.Z,{className:"default-btn add-btn",onClick:function(){N("/Subscribe/add")},children:"+ Subscribe"})]}),(0,m.jsxs)("div",{className:"ssv-main-content",children:[(0,m.jsx)("ul",{className:"header",children:C.map((function(e,t){return(0,m.jsx)("li",{style:{width:e.width},className:"header-item",children:e.title},t)}))}),k&&(0,m.jsx)("div",{className:"loading",children:(0,m.jsx)(d.Z,{style:{fontSize:50}})}),!k&&(0,m.jsx)("ul",{className:"data-content",children:n.map((function(e,t){return(0,m.jsx)("li",{className:"data-content-item",children:C.map((function(t){var n=t.render?t.render(e[t.dataIndex],e):String(e[t.dataIndex]);return(0,m.jsx)("span",{style:{width:t.width},children:n},t.dataIndex)}))},t)}))})]}),(0,m.jsx)(l.Z,{className:"ssv-pagination",defaultCurrent:x,defaultPageSize:i.Dh,total:b,onChange:function(e){v(e),S(e)}})]})}}}]);
//# sourceMappingURL=main-c3bf0291.6b9ea9e0.js.map