"use strict";(self.webpackChunkssv_front=self.webpackChunkssv_front||[]).push([[1515],{21515:function(e,t,i){i.d(t,{N:function(){return O}});var a=i(48609),n=i(26871),r=i(75671),s=i(44046),o=i(60886),l=i(29315),u=function(){function e(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var e=l.qW.createCanvas();this.canvas=e}return e.prototype.update=function(e,t,i,a,n,r){var s=this._getBrush(),o=this._getGradient(n,"inRange"),l=this._getGradient(n,"outOfRange"),u=this.pointSize+this.blurSize,g=this.canvas,h=g.getContext("2d"),p=e.length;g.width=t,g.height=i;for(var d=0;d<p;++d){var c=e[d],m=c[0],y=c[1],v=a(c[2]);h.globalAlpha=v,h.drawImage(s,m-u,y-u)}if(!g.width||!g.height)return g;for(var f=h.getImageData(0,0,g.width,g.height),S=f.data,b=0,x=S.length,O=this.minOpacity,_=this.maxOpacity-O;b<x;){v=S[b+3]/256;var C=4*Math.floor(255*v);if(v>0){var w=r(v)?o:l;v>0&&(v=v*_+O),S[b++]=w[C],S[b++]=w[C+1],S[b++]=w[C+2],S[b++]=w[C+3]*v*256}else b+=4}return h.putImageData(f,0,0),g},e.prototype._getBrush=function(){var e=this._brushCanvas||(this._brushCanvas=l.qW.createCanvas()),t=this.pointSize+this.blurSize,i=2*t;e.width=i,e.height=i;var a=e.getContext("2d");return a.clearRect(0,0,i,i),a.shadowOffsetX=i,a.shadowBlur=this.blurSize,a.shadowColor="#000",a.beginPath(),a.arc(-t,t,this.pointSize,0,2*Math.PI,!0),a.closePath(),a.fill(),e},e.prototype._getGradient=function(e,t){for(var i=this._gradientPixels,a=i[t]||(i[t]=new Uint8ClampedArray(1024)),n=[0,0,0,0],r=0,s=0;s<256;s++)e[t](s/255,!0,n),a[r++]=n[0],a[r++]=n[1],a[r++]=n[2],a[r++]=n[3];return a},e}(),g=i(76884),h=i(52037),p=i(81640),d=i(8943);function c(e){var t=e.dimensions;return"lng"===t[0]&&"lat"===t[1]}var m=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.type,i}return(0,a.ZT)(t,e),t.prototype.render=function(e,t,i){var a;t.eachComponent("visualMap",(function(t){t.eachTargetSeries((function(i){i===e&&(a=t)}))})),this._progressiveEls=null,this.group.removeAll();var n=e.coordinateSystem;"cartesian2d"===n.type||"calendar"===n.type?this._renderOnCartesianAndCalendar(e,i,0,e.getData().count()):c(n)&&this._renderOnGeo(n,e,a,i)},t.prototype.incrementalPrepareRender=function(e,t,i){this.group.removeAll()},t.prototype.incrementalRender=function(e,t,i,a){var n=t.coordinateSystem;n&&(c(n)?this.render(t,i,a):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(t,a,e.start,e.end,!0)))},t.prototype.eachRendered=function(e){n.traverseElements(this._progressiveEls||this.group,e)},t.prototype._renderOnCartesianAndCalendar=function(e,t,i,a,n){var s,l,u,g,h=e.coordinateSystem,c=(0,p.H)(h,"cartesian2d");if(c){var m=h.getAxis("x"),y=h.getAxis("y");s=m.getBandWidth()+.5,l=y.getBandWidth()+.5,u=m.scale.getExtent(),g=y.scale.getExtent()}for(var v=this.group,f=e.getData(),S=e.getModel(["emphasis","itemStyle"]).getItemStyle(),b=e.getModel(["blur","itemStyle"]).getItemStyle(),x=e.getModel(["select","itemStyle"]).getItemStyle(),O=e.get(["itemStyle","borderRadius"]),_=(0,d.k3)(e),C=e.getModel("emphasis"),w=C.get("focus"),M=C.get("blurScope"),I=C.get("disabled"),R=c?[f.mapDimension("x"),f.mapDimension("y"),f.mapDimension("value")]:[f.mapDimension("time"),f.mapDimension("value")],z=i;z<a;z++){var D=void 0,A=f.getItemVisual(z,"style");if(c){var E=f.get(R[0],z),P=f.get(R[1],z);if(isNaN(f.get(R[2],z))||E<u[0]||E>u[1]||P<g[0]||P>g[1])continue;var k=h.dataToPoint([E,P]);D=new r.Z({shape:{x:k[0]-s/2,y:k[1]-l/2,width:s,height:l},style:A})}else{if(isNaN(f.get(R[1],z)))continue;D=new r.Z({z2:1,shape:h.dataToRect([f.get(R[0],z)]).contentShape,style:A})}if(f.hasItemOption){var T=f.getItemModel(z),Z=T.getModel("emphasis");S=Z.getModel("itemStyle").getItemStyle(),b=T.getModel(["blur","itemStyle"]).getItemStyle(),x=T.getModel(["select","itemStyle"]).getItemStyle(),O=T.get(["itemStyle","borderRadius"]),w=Z.get("focus"),M=Z.get("blurScope"),I=Z.get("disabled"),_=(0,d.k3)(T)}D.shape.r=O;var G=e.getRawValue(z),N="-";G&&null!=G[2]&&(N=G[2]+""),(0,d.ni)(D,_,{labelFetcher:e,labelDataIndex:z,defaultOpacity:A.opacity,defaultText:N}),D.ensureState("emphasis").style=S,D.ensureState("blur").style=b,D.ensureState("select").style=x,(0,o.k5)(D,w,M,I),D.incremental=n,n&&(D.states.emphasis.hoverLayer=!0),v.add(D),f.setItemGraphicEl(z,D),this._progressiveEls&&this._progressiveEls.push(D)}},t.prototype._renderOnGeo=function(e,t,i,a){var n=i.targetVisuals.inRange,r=i.targetVisuals.outOfRange,o=t.getData(),l=this._hmLayer||this._hmLayer||new u;l.blurSize=t.get("blurSize"),l.pointSize=t.get("pointSize"),l.minOpacity=t.get("minOpacity"),l.maxOpacity=t.get("maxOpacity");var h=e.getViewRect().clone(),p=e.getRoamTransform();h.applyTransform(p);var d=Math.max(h.x,0),c=Math.max(h.y,0),m=Math.min(h.width+h.x,a.getWidth()),y=Math.min(h.height+h.y,a.getHeight()),v=m-d,f=y-c,S=[o.mapDimension("lng"),o.mapDimension("lat"),o.mapDimension("value")],b=o.mapArray(S,(function(t,i,a){var n=e.dataToPoint([t,i]);return n[0]-=d,n[1]-=c,n.push(a),n})),x=i.getExtent(),O="visualMap.continuous"===i.type?function(e,t){var i=e[1]-e[0];return t=[(t[0]-e[0])/i,(t[1]-e[0])/i],function(e){return e>=t[0]&&e<=t[1]}}(x,i.option.range):function(e,t,i){var a=e[1]-e[0],n=(t=g.UI(t,(function(t){return{interval:[(t.interval[0]-e[0])/a,(t.interval[1]-e[0])/a]}}))).length,r=0;return function(e){var a;for(a=r;a<n;a++)if((s=t[a].interval)[0]<=e&&e<=s[1]){r=a;break}if(a===n)for(a=r-1;a>=0;a--){var s;if((s=t[a].interval)[0]<=e&&e<=s[1]){r=a;break}}return a>=0&&a<n&&i[a]}}(x,i.getPieceList(),i.option.selected);l.update(b,v,f,n.color.getNormalizer(),{inRange:n.color.getColorMapper(),outOfRange:r.color.getColorMapper()},O);var _=new s.ZP({style:{width:v,height:f,x:d,y:c,image:l.canvas},silent:!0});this.group.add(_)},t.type="heatmap",t}(h.Z),y=m,v=i(80654),f=i(47861),S=i(37999),b=function(e){function t(){var i=null!==e&&e.apply(this,arguments)||this;return i.type=t.type,i}return(0,a.ZT)(t,e),t.prototype.getInitialData=function(e,t){return(0,f.Z)(null,this,{generateCoord:"value"})},t.prototype.preventIncremental=function(){var e=S.Z.get(this.get("coordinateSystem"));if(e&&e.dimensions)return"lng"===e.dimensions[0]&&"lat"===e.dimensions[1]},t.type="series.heatmap",t.dependencies=["grid","geo","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},t}(v.Z),x=b;function O(e){e.registerChartView(y),e.registerSeriesModel(x)}}}]);
//# sourceMappingURL=1515.f8398bbe.js.map